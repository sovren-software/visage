<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<!--
  D-Bus system bus policy for org.freedesktop.Visage1.

  Only root may own the bus name (daemon runs as root).
  Any user may call Verify and Status (read-only operations).
  Mutation methods (Enroll, RemoveModel, ListModels) are restricted to root
  by omission from the default policy â€” only root's policy allows them.
-->
<busconfig>
  <!-- Daemon (root) may own the service and call all methods -->
  <policy user="root">
    <allow own="org.freedesktop.Visage1"/>
    <allow send_destination="org.freedesktop.Visage1"/>
  </policy>

  <!-- All users may call read-only methods -->
  <policy context="default">
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.Visage1"
           send_member="Verify"/>
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.Visage1"
           send_member="Status"/>
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.DBus.Properties"/>
  </policy>
</busconfig>
